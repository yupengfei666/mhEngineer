(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab2/baoxiuadd"],{"0ae5":function(t,e,n){"use strict";var o=n("866f"),r=n.n(o);r.a},"45dd":function(t,e,n){"use strict";n.r(e);var o=n("db2c"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},"4cac":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={uSearch:function(){return n.e("uview-ui/components/u-search/u-search").then(n.bind(null,"9e14"))},uForm:function(){return n.e("uview-ui/components/u-form/u-form").then(n.bind(null,"1b72"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"e512"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"77e0"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"8862"))},uTag:function(){return n.e("uview-ui/components/u-tag/u-tag").then(n.bind(null,"4ecf"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"f213"))},uSelect:function(){return n.e("uview-ui/components/u-select/u-select").then(n.bind(null,"b106"))},uToast:function(){return n.e("uview-ui/components/u-toast/u-toast").then(n.bind(null,"5355"))}},r=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.companySelectShow=!0},t.e1=function(e){t.userSelectShow=!0},t.e2=function(e){t.qzjSelectShow=!0},t.e3=function(e){t.ssjgSelectShow=!0})},i=[]},"866f":function(t,e,n){},"8a1a":function(t,e,n){"use strict";(function(t){n("db49");o(n("66fd"));var e=o(n("9411"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},9411:function(t,e,n){"use strict";n.r(e);var o=n("4cac"),r=n("45dd");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("0ae5");var s,a=n("f0c5"),u=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);e["default"]=u.exports},db2c:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("637a");function r(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function i(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var a={data:function(){return{form:{id:"",crane_id:"",qzjLabel:"",mechanism:"",ssjgLabel:"",gzh:"",product_type:"",company:"",companyId:"",report_person:"",create_person:"",create_person_id:"",report_tel:"",report_time:"",bug_description:"",report_img:[]},companyName:"",currentUserId:"",action:o.BASE_URL+"Image/PostUpload",show:{qzjInput:!1,ssjgInput:!1,jgButton:!0,contactInput:!1,contactButton:!0},typeList:[],qzjSelectShow:!1,ssjgSelectShow:!1,companySelectShow:!1,userSelectShow:!1,qzjList:[],ssjgList:[],companyList:[],userList:[],rules:{qzjLabel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],ssjgLabel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],report_tel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],create_person_id:[{required:!0,message:"请输入具体内容",trigger:"blur"}],company:[{required:!0,message:"请选择公司",trigger:"blur"}]}}},computed:{},methods:{tagSelect:function(t){var e,n=r(this.typeList);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.name===t){o.mode="plain"===o.mode?"dark":"plain";break}}}catch(i){n.e(i)}finally{n.f()}},removeImg:function(t,e){console.log(e),this.form.report_img=[];var n,o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;this.form.report_img.push(i.response.url)}}catch(s){o.e(s)}finally{o.f()}},uploadSuccess:function(t){this.form.report_img.push(t.url)},changeContactShow:function(){this.show.contactInput=!this.show.contactInput,this.form.create_person="",this.form.create_person_id="",this.form.report_tel=""},changeQzjShow:function(){this.show.qzjInput=!this.show.qzjInput,this.form.qzjLabel="",this.form.crane_id=-1,this.changeSsjgShow(),this.show.qzjInput?(this.show.jgButton=!1,this.show.ssjgInput=!0):this.show.jgButton=!0},changeSsjgShow:function(){this.show.ssjgInput=!this.show.ssjgInput,this.form.ssjgLabel="",this.form.mechanism=-1},getCranesByCompany:function(t){var e=this,n={companyID:t};this.$myHttp("WaterData/GetCranesInCompany",n).then((function(t){if(console.log(t),0!==t.length){e.qzjList=[];var n,o=r(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;e.qzjList.push({value:i.ID,label:i.起重机名称})}}catch(s){o.e(s)}finally{o.f()}e.form.crane_id=e.qzjList[0].value,e.form.qzjLabel=e.qzjList[0].label,e.getJgList()}else console.log(111)}))},getProductType:function(){var t=this,e={pageIndex:1,pageSize:20,pid:"all",name:"产品类型"};this.$myHttp("Dict/SelectSysDictType",e).then((function(e){if(0!==e.Total){var n={pageIndex:1,pageSize:1e3,dict_id:e.Data[0].ID};t.$myHttp("Dict/SelectSysDictTree",n).then((function(e){t.typeList=[];var n,o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;t.typeList.push({name:i.name,mode:"plain"})}}catch(s){o.e(s)}finally{o.f()}}))}}))},submitData:function(){var e,n=this,o=[],i=r(this.typeList);try{for(i.s();!(e=i.n()).done;){var s=e.value;"dark"===s.mode&&o.push(s.name)}}catch(a){i.e(a)}finally{i.f()}0!==o.length?(this.form.product_type=o.length>0?JSON.stringify(o):"",this.$refs.uForm.validate((function(e){if(e){var o={OrderID:n.form.id,CraneID:n.form.crane_id,CraneName:n.form.qzjLabel,MechanismID:n.form.mechanism,MechanismName:n.form.ssjgLabel,ProjectNumber:n.form.gzh,ProductType:n.form.product_type,Describe:n.form.bug_description,ContactPerson:n.form.create_person_id,ReportPerson:n.currentUserId,ContactNumber:n.form.report_tel,PictureAddress:JSON.stringify(n.form.report_img),CompanyID:n.form.companyId},r={info:JSON.stringify(o),type:1};n.$myHttp("Order/AddOrder",r).then((function(e){n.$refs.uToast.show({title:"代报成功",type:"success"}),setTimeout((function(){t.navigateBack()}),600)}))}}))):this.$refs.uToast.show({title:"请选择产品类型",type:"error"})},qzjSelectChange:function(t){this.form.crane_id=t[0].value,this.form.qzjLabel=t[0].label,this.getJgList()},ssjgSelectChange:function(t){this.form.mechanism=t[0].value,this.form.ssjgLabel=t[0].label},companySelectChange:function(t){this.form.company=t[0].label,this.form.companyId=t[0].value,this.selectUser(),this.getCranesByCompany(this.form.companyId)},getCompanyList:function(){var t=this;console.log(23);var e={companyName:this.companyName};this.companyList=[],this.$myHttp("Main/GetAllCompany",e).then((function(e){var n,o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;t.companyList.push({value:i.ID,label:i.名称})}}catch(s){o.e(s)}finally{o.f()}t.form.company=t.companyList[0].label,t.form.companyId=t.companyList[0].value,t.selectUser(),t.getCranesByCompany(t.form.companyId)}))},userSelectChange:function(t){this.form.create_person=t[0].label,this.form.create_person_id=t[0].value,this.form.report_tel=t[0].extra},selectUser:function(){var t=this;this.userList=[];var e={CompanyID:this.form.companyId};this.$myHttp("Main/Get_UerInformation_CompanyID",e).then((function(e){var n,o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;t.userList.push({value:i.ID,label:i.真实姓名,extra:i.联系电话})}}catch(s){o.e(s)}finally{o.f()}console.log(t.userList),t.userList.length>0?(t.form.create_person=t.userList[0].label,t.form.create_person_id=t.userList[0].value,t.form.report_tel=t.userList[0].extra,t.show.contactButton=!0,t.show.contactInput=!1):(t.form.create_person="",t.form.create_person_id="",t.form.report_tel="",t.show.contactButton=!1,t.show.contactInput=!0)}))},getUserId:function(){var e=this,n={name:t.getStorageSync("name")};this.$myHttp("Main/GetUserInfo",n).then((function(t){e.currentUserId=t.ID}))},getJgList:function(){var t=this,e={cid:this.form.crane_id,Tags:JSON.stringify(["mechanism"]),toLevel:2,cal:0};this.ssjgList=[],this.$myHttp("AgentTree/GetNodesByTag",e).then((function(e){if(0===e.length)return t.show.ssjgInput=!0,t.form.mechanism=-1,t.form.ssjgLabel="",void(t.show.jgButton=!1);t.show.ssjgInput=!1,t.show.jgButton=!0;var n,o=r(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;t.ssjgList.push({value:i.ID,label:i.NodeConfig.ShowName})}}catch(s){o.e(s)}finally{o.f()}t.form.mechanism=t.ssjgList[0].value,t.form.ssjgLabel=t.ssjgList[0].label}))}},onReady:function(){this.$refs.uForm.setRules(this.rules)},onShow:function(){},onLoad:function(){this.getProductType(),this.getCompanyList(),this.getUserId()}};e.default=a}).call(this,n("543d")["default"])}},[["8a1a","common/runtime","common/vendor"]]]);